'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if('value'in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value}catch(error){reject(error);return}if(info.done){resolve(value)}else{return Promise.resolve(value).then(function(value){step('next',value)},function(err){step('throw',err)})}}return step('next')})}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError('Cannot call a class as a function')}}var nSQL=require('nano-sql').nSQL;var Model=function(){function Model(attributes){_classCallCheck(this,Model);Object.defineProperty(this,'_attributes',{value:attributes});Object.defineProperty(this,'_table',{writable:false});Object.defineProperty(this,'_keyAttribute',{value:'id',writable:true})}_createClass(Model,[{key:'getAttribute',value:function getAttribute(attr,def){if(this._attributes[attr]){return this._attributes[attr]}return def}},{key:'keyAttribute',get:function get(){return this._keyAttribute?this._keyAttribute:'id'}},{key:'table',get:function get(){return this._table?this._table:this.constructor.name.toLowerCase()}},{key:'attributes',get:function get(){return this._attributes}}],[{key:'create',value:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(attributes){var _this=this;return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:return _context.abrupt('return',new Promise(function(res,rej){nSQL(_this.table).query('upsert',attributes).exec().then(function(result,db){var model=new _this(result[1][0]);res(model)})}));case 1:case'end':return _context.stop();}}},_callee,this)}));function create(_x){return _ref.apply(this,arguments)}return create}()},{key:'all',value:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(){var _this2=this;return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt('return',new Promise(function(res,rej){nSQL(_this2.table).query('select').exec().then(function(result,db){var models=[];result.forEach(function(result){models.push(new _this2(result))});res(models)})}));case 1:case'end':return _context2.stop();}}},_callee2,this)}));function all(){return _ref2.apply(this,arguments)}return all}()},{key:'find',value:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(key){var _this3=this;return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt('return',new Promise(function(res,rej){nSQL(_this3.table).query('select').where([_this3.keyAttribute,'=',key]).exec().then(function(result,db){var model=new _this3(result[0]);res(model)})}));case 1:case'end':return _context3.stop();}}},_callee3,this)}));function find(_x2){return _ref3.apply(this,arguments)}return find}()},{key:'schema',get:function get(){throw new Error('Schema not declared')}},{key:'keyAttribute',get:function get(){return this._keyAttribute?this._keyAttribute:'id'}},{key:'table',get:function get(){return new this().table}}]);return Model}();module.exports=Model;